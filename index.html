<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AI vs. Human Essays</title>
<script src="https://d3js.org/d3.v7.min.js"></script>
<style>
  body {
    font-family: sans-serif;
    background-color: #121212;
    color: #eee;
    margin: 0;
    padding: 20px;
  }

  h1 {
    text-align: center;
    color: #fff;
  }

  p {
    max-width: 800px;
    margin: 0 auto 20px;
    line-height: 1.5em;
    color: #ccc;
  }

  #controls {
    text-align: center;
    margin-bottom: 20px;
  }

  button {
    background-color: #1e1e1e;
    border: 1px solid #444;
    color: #ddd;
    padding: 8px 14px;
    margin: 0 5px;
    cursor: pointer;
    border-radius: 5px;
    transition: background-color 0.2s;
  }
  button:hover {
    background-color: #333;
  }
  button.active {
    background-color: #444;
  }

  svg {
    display: block;
    margin: auto;
    background-color: #181818;
    border-radius: 5px;
  }

  .axis path, .axis line {
    stroke: #999;
  }
  .axis text {
    fill: #ccc;
  }
</style>
</head>
<body>

<h1>AI vs. Human Essays</h1>

<p>
This project explores a dataset of essays, each labeled as AI-generated or human-written.
Using simple text analysis, we compare metrics like word count and average sentence length between the two groups.
Toggle between metrics to see how writing style changes depending on the author.
</p>

<div id="controls">
  <button class="active" data-metric="wordCount">Word Count</button>
  <button data-metric="avgSentenceLength">Avg. Sentence Length</button>
</div>

<svg id="chart" width="800" height="500"></svg>

<script>
const csvFile = "AI Generated Essays Dataset.csv"; // Make sure file is in same folder

const svg = d3.select("#chart"),
      margin = {top: 40, right: 30, bottom: 60, left: 80},
      width = +svg.attr("width") - margin.left - margin.right,
      height = +svg.attr("height") - margin.top - margin.bottom;

const chartArea = svg.append("g")
  .attr("transform", `translate(${margin.left},${margin.top})`);

let dataProcessed, xScale, yScale, xAxisGroup, yAxisGroup, bars;

// Load CSV and process
d3.csv(csvFile).then(data => {
  data.forEach(d => {
    const words = d.text.trim().split(/\s+/);
    const sentences = d.text.split(/[.!?]+/).filter(s => s.trim().length > 0);
    d.wordCount = words.length;
    d.avgSentenceLength = d.wordCount / sentences.length;
    d.generated = +d.generated;
  });

  const grouped = d3.rollups(
    data,
    v => ({
      wordCount: d3.mean(v, d => d.wordCount),
      avgSentenceLength: d3.mean(v, d => d.avgSentenceLength)
    }),
    d => d.generated
  );

  // Convert group key to readable labels
  dataProcessed = grouped.map(([key, values]) => ({
    label: key === 1 ? "AI-generated" : "Human-written",
    ...values
  }));

  drawChart("wordCount");
});

function drawChart(metric) {
  // X scale - categories
  xScale = d3.scaleBand()
    .domain(dataProcessed.map(d => d.label))
    .range([0, width])
    .padding(0.3);

  // Y scale - metric values
  const maxVal = d3.max(dataProcessed, d => d[metric]);
  yScale = d3.scaleLinear()
    .domain([0, maxVal * 1.1])
    .nice()
    .range([height, 0]);

  // Axes
  if (!xAxisGroup) {
    xAxisGroup = chartArea.append("g")
      .attr("transform", `translate(0,${height})`)
      .attr("class", "axis x-axis")
      .call(d3.axisBottom(xScale));

    yAxisGroup = chartArea.append("g")
      .attr("class", "axis y-axis")
      .call(d3.axisLeft(yScale));

    // Y-axis label
    chartArea.append("text")
      .attr("transform", "rotate(-90)")
      .attr("y", -50)
      .attr("x", -height/2)
      .attr("dy", "-1.5em")
      .attr("text-anchor", "middle")
      .style("fill", "#ccc")
      .style("font-size", "14px")
      .attr("id", "y-label");
  } else {
    xAxisGroup.transition().duration(800)
      .call(d3.axisBottom(xScale));
    yAxisGroup.transition().duration(800)
      .call(d3.axisLeft(yScale));
  }

  // Bars
  if (!bars) {
    bars = chartArea.selectAll(".bar")
      .data(dataProcessed)
      .join("rect")
      .attr("class", "bar")
      .attr("x", d => xScale(d.label))
      .attr("width", xScale.bandwidth())
      .attr("y", height)
      .attr("height", 0)
      .attr("fill", "#4FC3F7")
      .transition()
      .duration(800)
      .ease(d3.easeCubicInOut)
      .attr("y", d => yScale(d[metric]))
      .attr("height", d => height - yScale(d[metric]));
  } else {
    bars.data(dataProcessed)
      .transition()
      .duration(800)
      .ease(d3.easeCubicInOut)
      .attr("y", d => yScale(d[metric]))
      .attr("height", d => height - yScale(d[metric]));
  }

  // Y-axis label text change
  d3.select("#y-label").text(
    metric === "wordCount" ? "Average Word Count" : "Average Sentence Length"
  );
}

// Button event listeners
d3.selectAll("#controls button").on("click", function() {
  const metric = d3.select(this).attr("data-metric");
  d3.selectAll("#controls button").classed("active", false);
  d3.select(this).classed("active", true);
  drawChart(metric);
});
</script>

</body>
</html>
