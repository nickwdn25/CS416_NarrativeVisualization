<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AI vs. Human Writing</title>
<script src="https://d3js.org/d3.v7.min.js"></script>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #121212;
    color: #fff;
    margin: 0;
    padding: 0;
  }
  header {
    text-align: center;
    padding: 20px;
  }
  h1 { margin-bottom: 5px; }
  .filter-buttons {
    text-align: center;
    margin: 10px 0;
  }
  .filter-buttons button {
    background: #333;
    color: white;
    border: none;
    padding: 8px 14px;
    margin: 0 5px;
    cursor: pointer;
    border-radius: 4px;
  }
  .filter-buttons button.active {
    background: #ff9800;
  }
  .charts {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-around;
    margin-top: 20px;
  }
  .chart {
    background: #1e1e1e;
    padding: 15px;
    border-radius: 8px;
    margin: 10px;
  }
  svg {
    background: #1e1e1e;
  }
  .preview-section {
    max-width: 900px;
    margin: 30px auto;
    background: #1e1e1e;
    padding: 20px;
    border-radius: 8px;
  }
  .essay {
    margin-bottom: 15px;
  }
  .essay p {
    margin: 5px 0;
  }
  .toggle {
    color: #ff9800;
    cursor: pointer;
    font-size: 0.9em;
  }
</style>
</head>
<body>

<header>
  <h1>AI vs. Human Writing</h1>
  <p>Explore the stylistic differences between AI-generated and human-written essays.</p>
</header>

<div class="filter-buttons">
  <button data-filter="all" class="active">All</button>
  <button data-filter="ai">AI Only</button>
  <button data-filter="human">Human Only</button>
</div>

<div class="charts">
  <div class="chart" id="wordCountChart">
    <h3>Average Word Count</h3>
    <svg width="400" height="300"></svg>
  </div>
  <div class="chart" id="sentenceLengthChart">
    <h3>Average Sentence Length (words)</h3>
    <svg width="400" height="300"></svg>
  </div>
  <div class="chart" id="commonWordsChart">
    <h3>Most Common Words</h3>
    <svg width="400" height="300"></svg>
  </div>
</div>

<div class="preview-section">
  <h3>Essay Previews</h3>
  <div id="essayPreviews"></div>
</div>

<script>
d3.csv("AI Generated Essays Dataset.csv").then(data => {
  data.forEach(d => {
    d.generated = +d.generated;
    d.wordCount = d.text.split(/\s+/).length;
    let sentences = d.text.split(/[.!?]+/).filter(s => s.trim().length > 0);
    d.avgSentenceLength = sentences.length ? d.wordCount / sentences.length : 0;
  });

  const filterButtons = document.querySelectorAll(".filter-buttons button");
  let currentFilter = "all";

  filterButtons.forEach(btn => {
    btn.addEventListener("click", () => {
      filterButtons.forEach(b => b.classList.remove("active"));
      btn.classList.add("active");
      currentFilter = btn.dataset.filter;
      updateDashboard();
    });
  });

  function getFilteredData() {
    if (currentFilter === "ai") return data.filter(d => d.generated === 1);
    if (currentFilter === "human") return data.filter(d => d.generated === 0);
    return data;
  }

  function updateDashboard() {
    const filtered = getFilteredData();

    drawBarChart("#wordCountChart svg", [
      {label: "AI", value: d3.mean(filtered.filter(d => d.generated === 1), d => d.wordCount) || 0},
      {label: "Human", value: d3.mean(filtered.filter(d => d.generated === 0), d => d.wordCount) || 0}
    ]);

    drawBarChart("#sentenceLengthChart svg", [
      {label: "AI", value: d3.mean(filtered.filter(d => d.generated === 1), d => d.avgSentenceLength) || 0},
      {label: "Human", value: d3.mean(filtered.filter(d => d.generated === 0), d => d.avgSentenceLength) || 0}
    ]);

    drawCommonWords(filtered);

    drawPreviews(filtered);
  }

  function drawBarChart(svgSelector, dataArray) {
    const svg = d3.select(svgSelector);
    svg.selectAll("*").remove();
    const width = +svg.attr("width");
    const height = +svg.attr("height");
    const margin = {top: 20, right: 20, bottom: 30, left: 50};

    const x = d3.scaleBand().domain(dataArray.map(d => d.label))
      .range([margin.left, width - margin.right]).padding(0.3);

    const y = d3.scaleLinear().domain([0, d3.max(dataArray, d => d.value)]).nice()
      .range([height - margin.bottom, margin.top]);

    svg.append("g")
      .attr("transform", `translate(0,${height - margin.bottom})`)
      .call(d3.axisBottom(x));

    svg.append("g")
      .attr("transform", `translate(${margin.left},0)`)
      .call(d3.axisLeft(y));

    svg.selectAll(".bar")
      .data(dataArray)
      .join("rect")
      .attr("class", "bar")
      .attr("x", d => x(d.label))
      .attr("y", d => y(d.value))
      .attr("height", d => y(0) - y(d.value))
      .attr("width", x.bandwidth())
      .attr("fill", "#ff9800");
  }

  function drawCommonWords(filtered) {
    const aiText = filtered.filter(d => d.generated === 1).map(d => d.text).join(" ");
    const humanText = filtered.filter(d => d.generated === 0).map(d => d.text).join(" ");
    const allWords = (aiText + " " + humanText).toLowerCase().match(/\b[a-z]{3,}\b/g) || [];

    const freq = {};
    allWords.forEach(w => freq[w] = (freq[w] || 0) + 1);
    const topWords = Object.entries(freq).sort((a,b) => b[1]-a[1]).slice(0,10)
      .map(([word, count]) => ({label: word, value: count}));

    drawBarChart("#commonWordsChart svg", topWords);
  }

  function drawPreviews(filtered) {
    const container = d3.select("#essayPreviews");
    container.selectAll("*").remove();

    const ai = filtered.filter(d => d.generated === 1).slice(0, 10);
    const human = filtered.filter(d => d.generated === 0).slice(0, 10);

    container.append("h4").text("AI Essays");
    ai.forEach(e => addEssayPreview(container, e));

    container.append("h4").text("Human Essays");
    human.forEach(e => addEssayPreview(container, e));
  }

  function addEssayPreview(container, entry) {
    const div = container.append("div").attr("class", "essay");
    const preview = entry.text.slice(0, 200) + (entry.text.length > 200 ? "..." : "");
    const p = div.append("p").text(preview);
    if (entry.text.length > 200) {
      div.append("span")
        .attr("class", "toggle")
        .text("View full text")
        .on("click", function() {
          if (p.text() === preview) {
            p.text(entry.text);
            d3.select(this).text("Show less");
          } else {
            p.text(preview);
            d3.select(this).text("View full text");
          }
        });
    }
  }

  updateDashboard();
});
</script>
</body>
</html>
